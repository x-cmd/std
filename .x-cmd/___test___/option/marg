# shellcheck shell=sh disable=SC2039,SC2142,SC3043

param_type    paramtest     url_type        "=~"  "https?://.+"
mul_arg(){
    param:scope     "paramtest/$O"
    param:dsl       '
option:
    --card|-c|m "Provide multiple action card in following format. [ <title> <message-url> <picture-url> ] ..."
            <title>
            <message-url>:url_type
            <picture-url>:url_type
'
    param:run

    IFS="
"
    for i in $(param_marg card); do
        printf "%s\n" "title: $(param_marg_get card "$i" 1)"
        printf "%s\n" "message-url: $(param_marg_get card "$i" 2)"
        printf "%s\n" "picture-url: $(param_marg_get card "$i" 3)"
    done
}

test_mul_arg(){
    @assert stdout mul_arg  \
        --card "test1" "https://www.dingtalk.com" "https://gw.alicdn.com" \
        --card "test2" "https://www.dingtalk.com" "https://gw.alicdn.com" \
        --card "test3" "https://www.dingtalk.com" "https://gw.alicdn.com" <<A
title: test1
message-url: https://www.dingtalk.com
picture-url: https://gw.alicdn.com
title: test2
message-url: https://www.dingtalk.com
picture-url: https://gw.alicdn.com
title: test3
message-url: https://www.dingtalk.com
picture-url: https://gw.alicdn.com
A
}

@assert:file:func