___x_cmd_ui_region_autorefresh_mainloop(){
    local fun="${1:?Provide handler}"; shift

    {
        trap ' :; ' INT
        ___x_cmd_pidofsubshell
        local ticks=1
        while true; do
            ticks="$((ticks+1))"
            printf "R:%s\n" "$ticks"
            sleep "${___X_CMD_UI_REFRESH_INTERVAL:-0.2}" || break
        done
    } | {
        local PID_OF_UPSUBSHELL
        read -r PID_OF_UPSUBSHELL

        "$fun" "$@"
        kill -SIGPIPE "$PID_OF_UPSUBSHELL"
    }
}