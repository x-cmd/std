# shellcheck shell=sh

. ./testcase/v0_test_base

##################
## Test functions
##################

test_proxy_advise_json() {
  assert_stdout "advise cat proxy" <<A
{
  "set": null,
  "unset": null,
  "version": null,
  "pip": {
    "url": {
      "qinghua|qh|tsinghua|tuna": null,
      "ustc": null,
      "aliyun": null,
      "huazhong": null,
      "douban": null,
      "tencent|qq|weixin": null
    },
    "get": {
    },
    "set": {
      "qinghua|qh|tsinghua|tuna": null,
      "ustc": null,
      "aliyun": null,
      "huazhong": null,
      "douban": null,
      "tencent|qq|weixin": null
    },
    "unset": {
    }
  },
  "npm": {
    "url": {
      "aliyun|ali": null,
      "official": null
    },
    "set": {
      "aliyun|ali": null,
      "official": null
    },
    "get": {
    },
    "unset": {
    }
  },
  "maven": null,
  "go": {
    "auto|autoset": {
    },
    "unset|reset": {
    },
    "gosumdb|sumdb|sum|gosum": {
      "set": {
      },
      "unset|reset|clear": {
      }
    },
    "set": {
      "aliyun|ali": null,
      "goproxy|goproxy": null,
      "qiniu|io|goproxy": null,
      "official": null
    },
    "service": {
    },
    "version": null,
    "tutorial|xman": {
    },
    "help": null
  },
  "gem": null,
  "cargo": {
    "url": {
      "ustc": null,
      "official": null
    },
    "get": null,
    "replace": {
      "ustc": null,
      "official": null
    },
    "rollback": {
    }
  },
  "apt": {
    "url": {
      "ali": null,
      "tuna": null
    },
    "replace": {
      "ali": null,
      "tuna": null
    },
    "rollback": {
      "ls": {
      },
      "use": {
        "#1": [  ]
      }
    }
  },
  "yum": {
    "url": {
      "ustc": null,
      "official": null
    },
    "get": null,
    "rollback": {
      "ls": {
      },
      "use": {
        "#1": [  ]
      }
    },
    "replace": {
      "ustc": null,
      "official": null
    }
  },
  "brew": {
    "url": {
      "tuna|tsinghua|qh": null,
      "aliyun|ali": null,
      "tencent": null,
      "bfsu": null,
      "ustc": null,
      "custom": null
    },
    "get": {
    },
    "set": {
      "--verbose|-v": null,
      "bfsu": null,
      "tuna|tsinghua|qh": null,
      "tencent": null,
      "aliyun|ali": null,
      "ustc": null,
      "custom": null
    },
    "unset": {
      "--verbose|-v": null
    }
  },
  "apk": {
    "url": {
      "ustc": null,
      "official": null
    },
    "get": null,
    "replace": {
      "ustc": null,
      "official": null
    },
    "rollback": {
      "ls": {
      },
      "use": {
        "#1": [  ]
      }
    }
  }
}
A
}

##################
## Run test
##################

if [ -n "${BASH_VERSION}${ZSH_VERSION}" ]; then
    test_proxy_advise_json
fi

case $1 in
    apt|apk|yum)
        . ./testcase/v0_test_"${1}"
        test_cross_env
        ;;
    go|brew|gem|cargo|npm|pip|maven)
        . ./testcase/v0_test_"${1}"
        ;;  
    base)
        ;;
    *)
        echo "Usage: x test {brew|apt|yum|apk|npm|pip|gem|cargo|go|maven|base}"
        exit 1
        ;;
esac
